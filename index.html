<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Functional Task Timer</title>
    <style>
        :root {
            --bg: #f0f2f5; --card: #ffffff; --text: #2f2f2f;
            --primary: #ff6b6b; --secondary: #4ecdc4; --accent: #ddd;
        }
        /* ãƒŠã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰è¨­å®š */
        body.dark-mode {
            --bg: #1a1a1a; --card: #2d2d2d; --text: #e0e0e0;
            --accent: #444; --secondary: #00adb5;
        }
        body { background-color: var(--bg); color: var(--text); font-family: sans-serif; transition: 0.3s; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { display: flex; gap: 20px; max-width: 900px; width: 100%; flex-wrap: wrap; }
        .card { background: var(--card); padding: 2rem; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); flex: 1; min-width: 320px; }
        
        .timer-display { font-size: 5rem; font-weight: bold; text-align: center; margin: 20px 0; font-variant-numeric: tabular-nums; }
        .controls, .settings { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        input, select { background: var(--card); color: var(--text); border: 1px solid var(--accent); padding: 8px; border-radius: 5px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        
        .btn-start { background-color: var(--secondary); color: white; }
        .btn-theme { margin-bottom: 20px; background-color: var(--accent); color: var(--text); }

        .task-input-group { display: flex; gap: 5px; margin-bottom: 15px; }
        ul { list-style: none; padding: 0; }
        li { 
            background: var(--bg); margin-bottom: 8px; padding: 12px; border-radius: 8px; 
            display: flex; justify-content: space-between; align-items: center; border-left: 6px solid #ccc;
        }
        /* é‡è¦åº¦åˆ¥ã®è‰² */
        li.high { border-left-color: #ff6b6b; }
        li.mid  { border-left-color: #ffd93d; }
        li.low  { border-left-color: #6bc1ff; }
        .task-done { text-decoration: line-through; opacity: 0.5; }
    </style>
</head>
<body>

<button class="btn-theme" onclick="toggleTheme()">ğŸŒ™ ãƒŠã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>

<div class="container">
    <div class="card">
        <h2>â±ï¸ Timer</h2>
        <div class="settings">
            <input type="number" id="mIn" value="25" min="0" style="width:50px">åˆ†
            <input type="number" id="sIn" value="0" min="0" max="59" style="width:50px">ç§’
        </div>
        <div class="timer-display" id="disp">25:00</div>
        <div class="controls">
            <button class="btn-start" id="startBtn" onclick="toggleTimer()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
            <button onclick="resetTimer()">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ“ Tasks</h2>
        <div class="task-input-group">
            <input type="text" id="tIn" placeholder="ã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›..." style="flex:1">
            <select id="pIn">
                <option value="high">é«˜</option>
                <option value="mid" selected>ä¸­</option>
                <option value="low">ä½</option>
            </select>
            <button class="btn-start" onclick="addTask()">è¿½åŠ </button>
        </div>
        <ul id="list"></ul>
    </div>
</div>

<script>
    let timer, timeLeft, isRunning = false;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // ã‚¢ãƒ©ãƒ¼ãƒ éŸ³ã®ç”Ÿæˆï¼ˆãƒ“ãƒ¼ãƒ—éŸ³ï¼‰
    function playSound() {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine';
        osc.frequency.setValueAtTime(880, audioCtx.currentTime); // ãƒ©ã®éŸ³
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        osc.start();
        osc.stop(audioCtx.currentTime + 1.5); // 1.5ç§’é³´ã‚‰ã™
    }

    function updateDisp() {
        const m = Math.floor(timeLeft / 60), s = timeLeft % 60;
        document.getElementById('disp').textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }

    function toggleTimer() {
        if (isRunning) {
            clearInterval(timer);
            document.getElementById('startBtn').textContent = 'å†é–‹';
        } else {
            if (!timeLeft) timeLeft = parseInt(document.getElementById('mIn').value) * 60 + parseInt(document.getElementById('sIn').value);
            timer = setInterval(() => {
                if (--timeLeft < 0) {
                    clearInterval(timer); 
                    playSound(); 
                    alert("æ™‚é–“ã«ãªã‚Šã¾ã—ãŸï¼"); 
                    resetTimer(); 
                    return;
                }
                updateDisp();
            }, 1000);
            document.getElementById('startBtn').textContent = 'åœæ­¢';
        }
        isRunning = !isRunning;
    }

    function resetTimer() {
        clearInterval(timer); isRunning = false;
        timeLeft = parseInt(document.getElementById('mIn').value) * 60 + parseInt(document.getElementById('sIn').value);
        updateDisp();
        document.getElementById('startBtn').textContent = 'ã‚¹ã‚¿ãƒ¼ãƒˆ';
    }

    function addTask() {
        const val = document.getElementById('tIn').value;
        const priority = document.getElementById('pIn').value;
        if (!val) return;
        const li = document.createElement('li');
        li.className = priority;
        li.innerHTML = `<span>${val}</span><input type="checkbox" onchange="this.parentElement.classList.toggle('task-done')">`;
        document.getElementById('list').prepend(li); // æ–°ã—ã„ã‚‚ã®ã‚’ä¸Šã«è¿½åŠ 
        document.getElementById('tIn').value = '';
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
    }

    // æ•°å€¤å¤‰æ›´æ™‚ã«ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
    document.getElementById('mIn').onchange = resetTimer;
    document.getElementById('sIn').onchange = resetTimer;
    resetTimer();
</script>
</body>
</html>
